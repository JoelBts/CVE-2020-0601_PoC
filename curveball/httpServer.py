import http.server
import ssl

# Server certificate and key + spoofed CA certificate used to sign
server_cert = 'cert.crt'
server_key = 'cert.key'
ca_cert = 'spoofed-ca.pem'

# HTTP Request Handler
class RequestHandler(http.server.SimpleHTTPRequestHandler):
    def do_GET(self):
        self.send_response(200)
        self.end_headers()
        self.wfile.write(b"Hello, world!")

# SSL Context
ssl_context = ssl.create_default_context(ssl.Purpose.CLIENT_AUTH)
ssl_context.load_cert_chain(certfile=server_cert, keyfile=server_key)
ssl_context.load_verify_locations(cafile=ca_cert)

# HTTPS Server on HTTPS port 443
server_address = ('', 443)
httpd = http.server.HTTPServer(server_address, RequestHandler)
httpd.socket = ssl_context.wrap_socket(httpd.socket, server_side=True)

# Start server
print("Server started on port 443...")
httpd.serve_forever()
